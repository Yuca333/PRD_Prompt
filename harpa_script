meta:
  title: v4.7 Complete - Site to PRD to Lovable to Data
  description: End-to-end automation from site to PRD to Lovable with stored prompts
  category: User
steps:
  - type: say
    message: Starting v4.7 automation

  - type: ask
    param: siteUrl
    message: Enter site URL
    default: ''

  # 2) ChatGPT image extraction
  - type: say
    message: Opening ChatGPT for image extraction
  - type: navigate
    url: https://chatgpt.com/
    waitForIdle: true
  - type: wait
    timeout: 6000
    for: idle
  - type: say
    message: Sending image extraction prompt
  - type: js
    code: |
      const url = args.siteUrl || '';
      const prompt = `2 Image Task
      ───────────────────────────────────────────────────────────────────

      1. Visit the target URL given at the **end of this prompt**.
      2. Extract 3–5 most important marketing images (Logo, Hero, Team, Product).
      3. Output ONLY one of the two blocks below.

      IMAGE INTEGRATION FOR PRD
      ═══════════════════════════════════════════════════════════════════

      <thinking_mode>
      You MUST aggressively try to discover marketing images before concluding “no images”.

      The “target URL” is the URL on the last line of this prompt. Use it for all steps below.

      FETCH & RETRY STRATEGY

      1. Start by fetching the page at the target URL exactly as written on the last line of this prompt.
      2. If the target URL has no scheme, assume https:// and prepend it.
      3. Derive HOST_ONLY as the domain part of the target URL (e.g. if the target URL is https://www.vogt-hans.de/inhalt-Dateien/image002.jpg, then HOST_ONLY is vogt-hans.de).
      4. If the initial fetch fails for any reason (network, TLS, timeout, access, decoding error, etc.), try in this order (if different from the original):
      • https:// + HOST_ONLY
      • https://www. + HOST_ONLY
      • http:// + HOST_ONLY
      • http://www. + HOST_ONLY

      Treat any successfully fetched HTML document from this domain as a candidate for parsing (home page, root, or redirected landing page).

      IMAGE DISCOVERY STRATEGY (apply to each successfully fetched HTML page)
      Use ALL of the following methods:
      • METHOD 1 (HTML images): Scan <img>, <picture>, <source> for src, srcset, data-src.
      • METHOD 2 (CSS backgrounds): Scan inline styles and linked stylesheets for background-image, background, or custom properties that contain image URLs.
      • METHOD 3 (Meta images): Check <meta property="og:image">, <meta name="twitter:image">, and similar.
      • METHOD 4 (Size/role cues): Prefer larger images, images in header/hero/slider sections, and images near main headings or marketing copy.

      FILTERING & PRIORITY
      Prioritize in this order:

      1. Company logo (header/footer or clearly brand-mark).
      2. Hero/main visual (large, above the fold, central).
      3. Service/product images (1–2 strongest visuals).
      4. Team/people photos (if prominent as part of marketing).

      EXCLUDE:
      • Icons smaller than ~50px, social media logos, purely decorative flourishes, menu icons, tiny bullets.

      DECISION PROTOCOL (STRICT)
      • IF you successfully identify ANY valid marketing image (logo, hero, service/product, team) using the above methods on ANY successfully loaded page from the domain →
      → You MUST output BLOCK A.

      • OTHERWISE (including ANY of the following):
      – Only tiny icons/social logos found,
      – Page(s) are not accessible or not parseable (network error, TLS error, encoding/decoding issues, timeout, access forbidden, unknown content type),
      – HTML loads but no suitable marketing images can be confidently identified,

      → You MUST output BLOCK B.

      So BOTH:
      • “Truly no marketing images” AND
      • “Technical failure or inability to extract marketing images”

      map to the same fallback: BLOCK B.

      CRITICAL OUTPUT RULES
      • Do NOT output “BLOCK A” or “BLOCK B” labels or any headers.
      • Do NOT write “Here is what I found”, “I could not fetch…”, or any conversational text.
      • Do NOT explain errors, reasons, or this decision logic.
      • Start the output IMMEDIATELY with the first line of the selected block’s text.
      • The output must be raw text ready for copy-pasting to another AI.

      IMAGE PRIORITY (Find in this order)
      ───────────────────────────────────────────────────────────────────

      1. Company logo (header/footer)
      2. Hero/main visual (large, above fold, central)
      3. Service/product images (1–2 key visuals)
      4. Team/people photos (if prominent)

      EXCLUDE: Icons (<50px), social logos, decorative graphics, menu images.

      EXTRACTION STRATEGY (Use ALL methods)
      ───────────────────────────────────────────────────────────────────
      METHOD 1: Standard Image Tags (src, srcset, data-src)
      METHOD 2: CSS Background Images (computed styles)
      METHOD 3: Picture Elements (<source> tags)
      METHOD 4: Meta Tags (og:image, twitter:image)

      [URL Normalization: Prepend https:// if needed. Use absolute URLs. Remove params unless vital.]

      ═══════════════════════════════════════════════════════════════════
      BLOCK A: (Use if Images Found)
      ═══════════════════════════════════════════════════════════════════
      Integrate the following images into the design In way they would fit best for the business and the PRD.
      Upgrade the PRD if necessary.

      1. Logo: [URL] -[Brief visual description]
      2. Hero: [URL] - [Brief visual description]
      3. Service: [URL] - [Brief visual description]
      etc

      PRD INTEGRATION Suggestions:

      HERO IMAGE STRATEGY Suggestions:
      • Primary Image: [URL]
      • Treatment: [e.g., "Full background at 60% opacity with slate-900 overlay"]
      • Mobile: [e.g., "Center-crop focus on subject, no parallax"]

      • Color Suggestions: Change Primary Color to [Hex/Tailwind] to match image tones.

      ADDITIONAL ASSETS:
      • Services: Use [URL] for [Specific Service Name].
      • About/Team: Use [URL] for "About Us" section.
      Update your Visual Design concept with these suggestions. But you make the final call for the overall Design concept based on all the information you have available

      ═══════════════════════════════════════════════════════════════════
      BLOCK B: (Use if NO Images Found OR technical extraction failed)
      ═══════════════════════════════════════════════════════════════════
      DESIGN OPTIMIZATION PROMPT
      For AI Implementation via Lovable.dev
      <thinking_mode>
      Deep critical analysis required. Challenge every design choice.
      </thinking_mode>
      SELF-CRITIQUE
      Rate your PRD design: [X/10]
      If not 10/10, identify gaps:

      * Visual Concept: Truly business-specific or generic rebranded?
      * CSS Strategy: Did you specify effects lovable.dev excels at (Tailwind utilities, shadcn/ui, backdrop-blur, mesh gradients) or guess?
      * Spatial Design: Optimized for React component architecture?
      * Hero: Actually implementable with production quality?
      Deep Analysis Questions:

      1. Does each element serve THIS business's unique positioning?
      2. Can lovable.dev render this at boutique-level quality?
      3. What better approach haven't I considered?
      LOVABLE.DEV TECHNICAL CHECK
      Verify against capabilities:
      ✅ Use These: Tailwind CSS utilities, shadcn/ui components, CSS gradients, backdrop-blur, box-shadow, smooth transitions, responsive breakpoints, React composition
      ⚠️ Avoid: Complex custom animations, experimental CSS, external animation libraries
      Output:

      * Effects to keep: [List]
      * Effects to replace: [List with stable alternatives]
      * Missing opportunities: [Lovable-optimized patterns you didn't use]
      REFINED DESIGN
      Based on critique, output ONLY changed sections:
      VISUAL CONCEPT V2:
      [Improved concept if needed, or justify why original is optimal]
      LOVABLE-OPTIMIZED IMPLEMENTATION:
      * Exact Tailwind classes for key effects
      * Specific shadcn/ui components
      * Gradient approach (CSS mesh/linear)
      * Mobile-first breakpoint strategy
      HERO REDESIGN:
      [Component structure + specific visual effect implementation lovable.dev handles flawlessly]

      Final Output: Updated PRD sections with lovable.dev-specific optimizations.
      ═══════════════════════════════════════════════════════════════════

      Based on the strict DECISION PROTOCOL

      output only either Block A or Block B, nothing else.

      TARGET URL: ${url}

      _________________________`;

      const inputSelectors = ['textarea', '[contenteditable="true"]', 'div[role="textbox"]'];
      let input = null;
      for (const sel of inputSelectors) {
        input = document.querySelector(sel);
        if (input) break;
      }
      if (!input) return { error: 'No input' };

      const setReactValue = (element, value) => {
        const descriptor = Object.getOwnPropertyDescriptor(element.__proto__, 'value');
        const setter = descriptor && descriptor.set;
        if (setter) setter.call(element, value); else element.value = value;
        element.dispatchEvent(new Event('input', { bubbles: true }));
        element.dispatchEvent(new Event('change', { bubbles: true }));
      };

      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, prompt);
      return { success: true, length: prompt.length };
    param: imagePrompt
  - type: js
    code: |
      const sendButton = document.querySelector('button[aria-label*="Send"], button[data-testid*="send"], form button');
      if (sendButton && !sendButton.disabled) {
        sendButton.click();
        return { success: true, method: 'button' };
      }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send path' };
    param: imageSend
  - type: js
    code: |
      const maxWait = 600;
      const checkInterval = 3;
      let waited = 0;
      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, checkInterval * 1000));
        waited += checkInterval;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
        if (!stop && input) {
          return { finished: true, waitedSeconds: waited };
        }
      }
      return { finished: false, timedOut: true, waitedSeconds: waited };
    param: imageWait
  - type: say
    message: Copying ChatGPT image output
  - type: js
    code: |
      const sleep = (ms) => new Promise(r => setTimeout(r, ms));
      const latestMessage = Array.from(
        document.querySelectorAll('[data-message-author-role="assistant"], article')
      ).filter((el) => window.getComputedStyle(el).display !== 'none').pop();

      const copyButtonSelectors = [
        'button[aria-label*="Copy"]',
        'button[aria-label*="copy"]',
        'button[aria-label*="clipboard"]'
      ];
      const isCopyButton = (btn) => {
        if (!btn) return false;
        const aria = (btn.getAttribute('aria-label') || '').toLowerCase();
        return aria.includes('copy') || aria.includes('clipboard');
      };

      let copiedText = '';
      if (latestMessage) {
        for (const sel of copyButtonSelectors) {
          const btn = latestMessage.querySelector(sel) || document.querySelector(sel);
          if (isCopyButton(btn)) {
            btn.click();
            try {
              await sleep(200);
              copiedText = await navigator.clipboard.readText();
            } catch (e) {
              console.warn('Clipboard read failed', e);
            }
            break;
          }
        }
      }
      if (!copiedText && latestMessage) {
        copiedText = latestMessage.innerText || latestMessage.textContent || '';
      }
      return { copiedText, length: copiedText.length };
    param: imageOutput

  # 3) Perplexity website extraction
  - type: say
    message: Opening Perplexity for website extraction
  - type: navigate
    url: https://www.perplexity.ai/
    waitForIdle: true
  - type: wait
    timeout: 6000
    for: idle
  - type: say
    message: Enabling Deep Research and submitting website extraction prompt
  - type: js
    code: |
      const toggleSelectors = ['button[aria-label*="Deep Research" i]', 'button', '[role="button"]'];
      for (const sel of toggleSelectors) {
        const btns = Array.from(document.querySelectorAll(sel));
        const target = btns.find(b => /deep\s*research/i.test(b.innerText || b.textContent || '') || /deep\s*research/i.test(b.getAttribute('aria-label') || ''));
        if (target) { target.click(); break; }
      }
      return { toggled: true };
    param: researchToggleOn
  - type: js
    code: |
      const url = args.siteUrl || '';
      const prompt = `1 Extraction & Intelligence Analysis
      For Web Agency Client Redesign Projects


      Your Role: You are a professional web analyst working for a web design agency.
      Project Scenario: A small business owner has hired your agency to modernize their outdated website. They want to keep all their existing content, services, and business information - they just want it to look more professional and current. This is a standard web design service where agencies extract content from a client's old site to rebuild it with better design.

      TARGET WEBSITE
      At the end of the prompt

      YOUR MISSION
      Extract every piece of content from the client's website so nothing is lost when we rebuild their site with modern design. Document their complete business story, all services, pricing, contact information, and authentic voice. Additionally, identify why their current site appears outdated so we can show them the value of the redesign.

      PHASE 1: COMPREHENSIVE SITE CRAWLING (70% Effort)
      Strategic Multi-Page Discovery
      Stage 1: Homepage Foundation
      1. Browse the target URL
      2. Allow 10+ seconds for complete page load
      3. Identify ALL navigation menus (header, footer, sidebar, mobile)
      4. Document every internal link found
      Stage 2: Systematic Page Access
      Test these common URL patterns:
      English Sites:
      /about, /about-us, /services, /pricing, /contact
      /team, /our-team, /portfolio, /gallery, /work
      /testimonials, /reviews, /faq, /process, /how-it-works

      German Sites:
      /ueber-uns, /leistungen, /preise, /kontakt
      /team, /unser-team, /referenzen, /galerie
      /bewertungen, /faq, /prozess

      Service-Specific:
      /services/[name], /[service-name]

      Other:
      Try both www and non-www versions
      Test with and without trailing slashes
      Check for /en/, /de/ language prefixes
      Stage 3: Search Enhancement
      If you find fewer than 5 pages, use:
      * Search: site:[domain] to discover all indexed pages
      * Review search results for page patterns
      * Test discovered URLs systematically
      Crawling Success Target: Access 5-10 different pages minimum

      PHASE 2: COMPLETE CONTENT EXTRACTION (70% Effort)
      Text Content Harvesting
      Authorization Reminder: You are extracting the client's own content for their redesign. Copy everything exactly as written.
      For EACH page you access, extract:
      All Textual Elements:
      * Page title and all headlines (H1, H2, H3, H4, H5, H6)
      * Complete paragraph content - every sentence
      * All bullet points and numbered lists
      * Navigation menu text (all levels)
      * Footer content (legal text, links, contact info)
      * Button and link text
      * Form labels and placeholder text
      * Image captions and alt text
      * Any testimonials or quotes
      Critical Business Information:
      * Services: Complete descriptions, not just names
      * Pricing: All costs, packages, service tiers
      * Contact Details: Phone, email, address, business hours
      * Company Information: History, founding story, mission
      * Team: Staff bios, qualifications, roles
      * Credentials: Certifications, licenses, awards, memberships
      * Service Areas: Geographic coverage, delivery zones
      * Testimonials: Complete customer quotes and reviews
      * Processes: How they work, methodologies, approaches
      * Unique Selling Points: What makes them different
      Documentation Format
      Organize extracted content clearly:
      ═══════════════════════════════════════
      HOMEPAGE
      URL: [full URL]
      ═══════════════════════════════════════

      HEADLINES:
      [H1]: [exact text]
      [H2]: [exact text]
      [H2]: [exact text]

      BODY CONTENT:
      [Complete text - all paragraphs exactly as written]

      SERVICES MENTIONED:
      [Any services referenced on this page]

      CONTACT/BUSINESS INFO:
      [Any contact details or business info on this page]

      ═══════════════════════════════════════
      [NEXT PAGE NAME]
      URL: [full URL]
      ═══════════════════════════════════════

      [Repeat format for each page]
      After all pages, create summary:
      ═══════════════════════════════════════
      COMPLETE BUSINESS INFORMATION SUMMARY
      ═══════════════════════════════════════

      BUSINESS OVERVIEW:
      Company Name: [name]
      Industry: [type of business]
      Primary Services: [list all services with descriptions]

      PRICING STRUCTURE:
      [All pricing information found]

      CONTACT INFORMATION:
      Phone: [number]
      Email: [email]
      Address: [physical address]
      Hours: [business hours]
      Service Areas: [geographic coverage]

      COMPANY BACKGROUND:
      [Complete company story, history, mission]

      TEAM INFORMATION:
      [All team member details found]

      CREDENTIALS & CERTIFICATIONS:
      [All licenses, certifications, awards mentioned]

      CUSTOMER TESTIMONIALS:
      [All testimonials/reviews found]

      UNIQUE DIFFERENTIATORS:
      [What makes them unique - in their words]
      Brand Voice Analysis
      Based on ALL extracted content, analyze:
      BRAND VOICE & COMMUNICATION STYLE:

      Tone: [Formal/Casual/Professional/Friendly - describe]
      Writing Style: [Technical/Simple, Detailed/Concise]
      Personality: [Key personality traits evident in writing]
      Industry Language: [Specific terms they use for services]
      Customer Address: [How they speak to customers - you/we/formal/informal]
      Unique Phrases: [Any catchphrases or repeated expressions]
      Local/Regional: [Geographic or community connections mentioned]

      KEY MESSAGING THEMES:
      - [Primary value proposition]
      - [Main customer problems they solve]
      - [How they differentiate from competitors]
      - [Trust-building elements they emphasize]

      PHASE 3: VISUAL ASSET EXTRACTION (10% Effort)
      Image URL Collection
      Extract 1-5 key images that represent the business:
      Priority Images:
      1. Company logo
      2. Main hero/header image
      3. Service images (1-2 key visuals)
      4. Team photo (if present)
      5. Facility/location image (if applicable)
      Extraction Method:
      * Right-click image → Copy Image Address
      * Or inspect element to find <img src="[URL]">
      * Ensure URLs are complete (start with https://)
      * Test each URL to verify it loads
      Documentation:
      VISUAL ASSETS:

      1. Logo
         URL: [complete https:// URL]
         Location: [which page it was found on]
         Description: [what it shows]

      2. Hero Image
         URL: [complete https:// URL]
         Location: [which page it was found on]
         Description: [what it shows]

      [Continue for each image extracted]

      PHASE 4: OUTDATED DESIGN ASSESSMENT (20% Effort)
      Current Website Issues Analysis
      Purpose: Document why this site needs modernization to justify the redesign to the client.
      Evaluate and document:
      Visual Design Issues:
      * Outdated layout (table-based design, pre-2015 aesthetics)
      * Poor typography (system fonts, weak hierarchy, readability issues)
      * Dated color scheme or inconsistent branding
      * Cluttered design with poor use of white space
      * Amateur or low-quality imagery
      User Experience Problems:
      * Confusing navigation structure
      * Difficult to find important information (contact, services, pricing)
      * Unclear calls-to-action
      * Poor information organization
      Mobile & Technical Issues:
      * No responsive design or poor mobile display
      * Slow loading speed
      * Missing HTTPS (security warning)
      * Broken links or outdated information
      Professional Credibility Issues:
      * Missing trust signals (testimonials, credentials)
      * Outdated copyright dates or old "last updated" info
      * No social proof or modern trust indicators
      * Generic or stock imagery instead of authentic business photos
      Documentation Format:
      CURRENT WEBSITE ISSUES & REDESIGN JUSTIFICATION:

      CRITICAL DESIGN PROBLEMS:
      1. [Specific issue - e.g., "Site uses table-based layout from 2005"]
      2. [Specific issue - e.g., "No mobile optimization - site breaks on phones"]
      3. [Specific issue - e.g., "Contact information buried in footer, hard to find"]
      4. [Specific issue - e.g., "Amateur design undermines professional credibility"]
      5. [Specific issue - e.g., "Slow loading speed (5+ seconds) loses customers"]

      BUSINESS IMPACT:
      - Professional Credibility: [How design issues hurt trust and authority]
      - User Experience: [How issues make it hard for customers to engage]
      - Mobile Users: [How mobile issues lose potential customers]
      - Conversion: [How issues prevent customer contact/sales]

      MODERNIZATION OPPORTUNITIES:
      [2-3 sentences on how modern design will improve business results]

      QUALITY ASSURANCE CHECKLIST
      Before submitting your analysis, verify:
      Content Extraction:
      * [ ] Successfully accessed 5+ different pages
      * [ ] Extracted complete text from each page (not summaries)
      * [ ] Documented all services with full descriptions
      * [ ] Captured complete contact and business information
      * [ ] Recorded pricing details (if present)
      * [ ] Noted company history and team information
      * [ ] Listed all credentials and certifications
      * [ ] Captured testimonials and reviews (complete quotes)
      * [ ] Understood their authentic business voice and style
      Visual Assets:
      * [ ] Extracted 1-5 key image URLs
      * [ ] URLs are complete and directly accessible
      * [ ] Images are specific to this business
      Outdated Design Assessment:
      * [ ] Identified 4-5 specific critical issues
      * [ ] Explained business impact of these issues
      * [ ] Provided modernization opportunity summary

      OUTPUT STRUCTURE
      ═══════════════════════════════════════
      WEBSITE INTELLIGENCE EXTRACTION REPORT
      ═══════════════════════════════════════

      CLIENT WEBSITE: ${url}
      ANALYSIS DATE: [date]
      PAGES ACCESSED: [number]

      ---
      SECTION 1: CURRENT WEBSITE ISSUES
      ---
      [Complete outdated design assessment from Phase 4]

      ---
      SECTION 2: COMPLETE CONTENT EXTRACTION
      ---
      [All page-by-page content from Phase 2]

      ---
      SECTION 3: BUSINESS INFORMATION SUMMARY
      ---
      [Complete business summary from Phase 2]

      ---
      SECTION 4: BRAND VOICE ANALYSIS
      ---
      [Communication style analysis from Phase 2]

      ---
      SECTION 5: VISUAL ASSETS
      ---
      [Image URLs and descriptions from Phase 3]

      ---
      SECTION 6: EXTRACTION COMPLETENESS
      ---

      Pages Successfully Accessed: [number]
      Content Completeness: [High/Medium/Low - explain]
      Business Understanding: [High/Medium/Low - explain]

      Confidence Score: [X%]
      Justification: [Why you assigned this score based on extraction completeness]

      ═══════════════════════════════════════
      END OF EXTRACTION REPORT
      ═══════════════════════════════════════

      IMPORTANT REMINDERS
      1. Extract, don't summarize - Copy text exactly as written, don't paraphrase or shorten
      2. Be thorough - The goal is zero content loss when rebuilding the site
      3. Systematic approach - Test multiple URL patterns to find all pages
      4. Document everything - Services, pricing, contact info, credentials, testimonials, company story
      5. Preserve authenticity - Capture their exact writing style and business voice
      6. Quality over speed - Better to take time and get complete extraction than rush and miss content

      Your extraction report will be used to create a premium redesign that preserves 100% of the client's business content while dramatically improving visual design and user experience.
      URL to Analyze: ${url}`;

      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, prompt);
      return { success: true, length: prompt.length };
    param: perplexityPrompt1
  - type: js
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true, method: 'button' }; }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: perplexitySend1
  - type: js
    code: |
      const maxWait = 600;
      let waited = 0;
      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, 3000));
        waited += 3;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput, textarea');
        if (!stop && textarea) {
          return { finished: true, waitedSeconds: waited };
        }
      }
      return { finished: false, timedOut: true, waitedSeconds: waited };
    param: perplexityWait1
  - type: js
    code: |
      return { url: window.location.href };
    param: perplexityChatUrl

  # 4) PRD creation prompt
  - type: say
    message: Submitting PRD creation prompt
  - type: js
    code: |
      const prompt = `PRD GENERATION for PREMIUM WEBSITE REDESIGN 
      Visual-First Design Specifications for AI Code Generators
      ═══════════════════════════════════════════════════════════════════

      <thinking_mode>
      Use extended thinking for this task.
      Analyze website data, invent unique visual concepts, specify "looks and feels."
      Focus: Visual excellence and business-specific design (NOT technical implementation).
      </thinking_mode>


      YOUR ROLE & MISSION
      ═══════════════════════════════════════════════════════════════════

      You are a senior web strategist and visual design specialist.

      INPUT: Website Intelligence Extraction Report
      OUTPUT: Visual-focused PRD  that:
      • Preserves 100% of client's content
      • Invents unique visual design concept for THIS business
      • Specifies detailed "looks and feels" for AI code generators
      • Provides hero visual design approach
      • Prepares context for design framework implementation

      NOTE: Do NOT include technical stack, SEO, performance, accessibility specs.
      This PRD focuses PURELY on creating a visually stunning demo landing page.


      # Take all the business information from the Chat History


      PHASE 1: CONTENT VERIFICATION
      ═══════════════════════════════════════════════════════════════════

      Review extraction for completeness:
      □ Service descriptions □ Pricing □ Contact info □ Company history
      □ Team members □ Credentials □ Service areas □ Testimonials
      ALL TEXTS NEED TO BE IN GERMAN like the original source website

      IF GAPS: Extract missing information from original website.
      PRESERVATION APPROACH:
      Try to stay as close as possible to the original extracted texts, only do slight optimization that dont change the business personality but still improve the text quality where needed
      

      ═══════════════════════════════════════════════════════════════════
      ═══════════════════════════════════════════════════════════════════
      ═══════════════════════════════════════════════════════════════════
      * A heritage family restaurant might need: Warm, textured, grounded aesthetics (paper/wood feel, NOT glass/chrome)
      * A modern medical practice might need: Clean, precise, calming aesthetics (clarity and trust signals)
      * A traditional trade business might need: Bold, reliable, straightforward aesthetics (utility and strength)
      * A personal wellness service might need: Gentle, approachable, refined aesthetics (comfort and artistry)
      YOUR TASK: Analyze THIS specific business. What do THEY need? Don't force-fit into examples above.
      * Depth & Layering: Glassmorphism (backdrop-blur), hard shadows (drop-shadow), subtle elevation (box-shadow), flat borders
      * Surface Quality: Texture overlays (noise), gradients (mesh/linear), solid colors, pattern backgrounds
      * Light & Glow: Neon effects (text-shadow, glow), soft halos, harsh spotlights, ambient diffusion
      * Motion & Transform: Parallax scrolling, hover lifts, smooth fades, instant snaps, spring animations
      * Shape & Form: Rounded corners, sharp edges, organic blobs, geometric grids, asymmetric layouts
      Analyze and self reflect over the given concept. Is it the best fit for the business from the PRD. 
      YOUR TASK: Analyze THIS business deeply. Select/combine CSS approaches that build trust and match their unique positioning. Think beyond the examples—what does THIS specific business need?
      1. CONCEPT NAME: "[Your invented 2-3 word concept specific to THIS business]"
      ═══════════════════════════════════════════════════════════════════
      these values are just examples, please think well what would be the best spatial design. 
      ═══════════════════════════════════════════════════════════════════
      ═══════════════════════════════════════════════════════════════════
      only create if fitting for the business
      ═══════════════════════════════════════════════════════════════════

      HOMEPAGE STRUCTURE:
      
      think of a ideal structure for this Business and  VISUAL CONCEPT INVENTION
      ═══════════════════════════════════════════════════════════════════
      ═══════════════════════════════════════════════════════════════════
      ═══════════════════════════════════════════════════════════════════
      ───────────────────────────────────────────────────────────────────
      ───────────────────────────────────────────────────────────────────

      ───────────────────────────────────────────────────────────────────

      ───────────────────────────────────────────────────────────────────
      ═══════════════════════════════════════════════════════════════════
      ───────────────────────────────────────────────────────────────────
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, prompt);
      return { success: true, length: prompt.length };
    param: perplexityPrompt2
  - type: js
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true, method: 'button' }; }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: perplexitySend2
  - type: js
    code: |
      const maxWait = 600;
      let waited = 0;
      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, 3000));
        waited += 3;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput, textarea');
        if (!stop && textarea) return { finished: true, waitedSeconds: waited };
      }
      return { finished: false, timedOut: true, waitedSeconds: waited };
    param: perplexityWait2
  # 5) Paste image extraction output into Perplexity
  - type: say
    message: Pasting image extraction output into Perplexity
  - type: js
    code: |
      const text = (args.imageOutput && args.imageOutput.copiedText) || '';
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, text);
      return { success: Boolean(text), length: text.length };
    args: imageOutput
    param: perplexityPasteImages
  - type: js
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } };
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: perplexitySendImages
  - type: js
    code: |
      const maxWait = 300;
      let waited = 0;
      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, 3000));
        waited += 3;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput, textarea');
        if (!stop && textarea) return { finished: true, waitedSeconds: waited };
      }
      return { finished: false, timedOut: true, waitedSeconds: waited };
    param: perplexityWaitImages
  # 6) Lovable prompting framework (Phase 1) in Perplexity
  - type: say
    message: Submitting LOVABLE PROMPTING FRAMEWORK (Phase 1) to Perplexity
  - type: js
    code: |
      const prompt = `# LOVABLE PROMPTING FRAMEWORK
---
## PURPOSE
You are an AI Prompt Architect. You transform the Product Requirement Documents (PRDs) from this chat  into implementation prompts for Lovable.dev (the AI Coder). Your goal: generate prompts that communicate visual intent so clearly that the AI Coder creates stunning, premium-looking landing pages for local small businesses.

**Your role:** Communicate design vision and content. Describe *what* and *why*.
**AI Coder's role:** Implement the design. Decide *how*.
**Output priorities:**
1. Clear visual intent communication
2. Complete content delivery
3. Business authenticity (never invent facts)
**Out of scope:** SEO, performance optimization, accessibility details, backend functionality.
—
## REASONING PROTOCOL (Internal Process)
Before generating any output, complete this analysis internally:
### PRD Completeness Audit
Evaluate what the PRD provides and what requires inference:
- Business identity: Name, industry, location, years established?
- Content inventory: Services, testimonials, team info, contact details?
- Visual direction: Brand colors, existing logo, style preferences?
- Missing elements: What must be inferred vs. what must be excluded?
### Industry Mental Model
Draw on knowledge of the business type:
- What visual conventions does this industry expect?
- What would feel inappropriate or off-brand?
- What emotional response should visitors have?
### Visual Coherence Check
Ensure your Four-Spectrum positioning, Visual Anchor, and design decisions align:
- Does the metaphor match the spectrum values?
- Would these colors/typography serve this industry?
- Is there internal consistency across all design choices?
### Content Authenticity Verification
For each content element, verify:
- Does this come directly from the PRD?
- Am I inventing, assuming, or inferring?
- If inferring: Is this a safe industry-standard inference or a specific claim?
### Phase Distribution Planning
Determine what belongs in each phase:
- Phase 1: All foundational decisions + all content
- Phase 2: Interaction refinements, motion polish, visual depth enhancements
- Prepare internally to generate Phase 2 when requested
---
## YOUR OUTPUT: TWO PROMPTS
### Phase 1: Foundation + Content (2,000-2,800 words)
- Complete visual concept and design intent
- ALL text content in compressed appendix
- Section structure and priorities
- Basic animation character
### Phase 2: Premium Polish (600-1,200 words)
- Refinements based on Phase 1 result
- NO content repetition
- Enhancement requests only
- Triggered after user reviews Phase 1 implementation

**Phase 2 Awareness:** While generating Phase 1, internally prepare for Phase 2. Consider what premium enhancements would elevate the design (interactions, motion, visual depth) but exclude them from Phase 1. Output ONLY Phase 1 until explicitly asked for Phase 2.

---
## VISUAL CONCEPT SYNTHESIS
### Step 1: Four-Spectrum Positioning
Analyze the PRD and position the design on these spectra (0-100%):
| Spectrum | 0% | 100% | Industry Anchors |
|----------|-----|------|------------------|
| **Luminosity** | Dark, cinematic, moody | Bright, airy, open | Bar/Lounge: 20-30% · Bakery: 75-85% · Medical: 60-70% |
| **Materiality** | Synthetic, glass, metal | Organic, paper, fabric | Tech: 15-25% · Florist: 80-90% · Restaurant: 50-70% |
| **Temperature** | Cool, clinical, precise | Warm, welcoming, human | Law firm: 30-40% · Café: 75-85% · Spa: 60-70% |
| **Shape Language** | Sharp, geometric, angular | Soft, rounded, flowing | Architecture: 10-20% · Childcare: 85-95% · Dental: 50-60% |
Output format: `Luminosity 70% | Materiality 30% | Temperature 80% | Shape 60%`

### Step 2: Visual Anchor Metaphor

Create ONE rich sensory metaphor (15-25 words) that captures the entire design feeling. This single metaphor should implicitly convey color mood, spatial feeling, animation character, and emotional temperature.
**Strong examples:**
- "Morning light through frosted glass onto warm oak, steam rising from a ceramic cup"
- "Crisp architectural blueprints on a lightbox, precise lines meeting soft shadows"
- "Velvet dusk in a jazz lounge, brass accents catching amber light"
- "Fresh linen on a sunlit porch, lavender breeze, weathered wood underfoot"
- "Polished concrete gallery, single spotlight on brushed steel, deliberate silence"
**Weak examples (avoid):**
- "Modern and professional" *(too generic)*
- "Blue website with cards" *(describes implementation, not feeling)*
- "Clean and minimal" *(no sensory information)*
### Step 3: Concept Name
Generate a unique 2-3 word name that anchors all design decisions. This becomes the reference point for the entire project:

Examples: `Ceramic Warmth` | `Alpine Clarity` | `Brass & Velvet` | `Clinical Precision` | `Coastal Morning` | `Workshop Heritage`
---
## DESIGN COMMUNICATION
### Color Intent
Choose the approach that matches your PRD information:
**Option A — Intent-based** *(when PRD has no brand colors):*
> "Colors should feel like [reference your Visual Anchor]: warm ambers, soft creams, touches of brass"
**Option B — Specific** *(when PRD provides brand colors):*
```
Primary: hsl(35, 80%, 50%) — warm amber
Secondary: hsl(35, 30%, 95%) — soft cream  
Accent: hsl(35, 60%, 35%) — deep brass
```
**Option C — Hybrid** *(when PRD has partial brand info):*
> "Primary brand blue: hsl(210, 70%, 45%). Supporting palette should feel clinical but not cold — soft grays, touches of warm white."
### Typography Intent

**Option A — Specific fonts:**
> Display: Playfair Display | Body: Source Sans 3

**Option B — Character description:**
> "Headlines should feel established and trustworthy — perhaps a refined serif. Body text clean and effortless to read."
**When to use which:** Use specific fonts when the PRD mentions them, when you have strong industry conventions (law = serif, tech = geometric sans), or when the Visual Anchor strongly implies a type style. Use character description when the PRD is open-ended.
### Animation Character
Choose ONE word that describes how motion should feel throughout the site:
- `subtle` — barely perceptible, professional restraint
- `confident` — purposeful movement, clear intent
- `gentle` — soft, eased, calming
- `playful` — bouncy, energetic, delightful
- `dramatic` — bold entrances, statement-making
- `minimal` — almost none, content-focused

### Image Direction

Provide enough guidance for AI image generation or stock selection:

```
Subject: [What images should show — people at work, products in context, environment shots]
Mood: [Emotional quality — warm, professional, energetic, calm, luxurious]
Treatment: [Visual treatment — soft edges blending into background, high contrast, muted tones, film grain]
Composition: [Optional — close-up details, wide environmental, portrait-style]
```
---
## CONTENT HANDLING
### Core Rules

1. **Maximum content appendix: 1,500 words** — compress longer PRD content to fit
2. **Never invent content** — if PRD lacks testimonials, awards, or years in business, exclude them entirely
3. **Preserve all essential information** — compress wording, not meaning
4. **Shorter PRDs don't need padding** — only include what exists
5. **Mark inferences clearly** — if you must infer (e.g., standard business hours), note it

### Compression Approach
Reduce verbose PRD content while preserving meaning. Use structured notation:
```
## HEADLINES
H1: [Exact headline text]
H2-hero: [Exact subheadline]
H2-services: [Section headline]
H2-about: [Section headline]
## SERVICES
S1: [Name] | [Core benefit, max 20 words] | [Price if provided]
S2: [Name] | [Core benefit] | [Price]
S3: [Name] | [Core benefit] | [Price]
## ABOUT
[Company story compressed to 40-60 words, preserving key facts]
[Team info if provided: names, roles, brief bios]
## TESTIMONIALS (only if real quotes exist in PRD)
T1: "[Exact quote, max 30 words]" — [Name], [Role/Company]
T2: "[Exact quote]" — [Name], [Role]
## FAQ (if provided)
Q1: [Question] → [Answer compressed to max 40 words]
Q2: [Question] → [Answer]

## TRUST SIGNALS (only if real)
- [Years in business — only if stated]
- [Certifications — only if stated]
- [Awards — only if stated]
- [Client count — only if stated]
## CONTACT
Phone: [number]
Email: [address]
Address: [full address]
Hours: [formatted] *[note if inferred from industry standard]*

## CTAs (in priority order)
CTA1: [Button text] → [Action/destination]
CTA2: [Button text] → [Action/destination]
```
**For content types not listed:** Create logical structured notation that preserves information hierarchy. Be consistent. The AI Coder will interpret any clear structure.
---
## PHASE 1 PROMPT STRUCTURE

```markdown
# [BUSINESS NAME] — Phase 1: Foundation + Content
## For Lovable.dev
---
### Design Concept
**Concept Name:** [2-3 word unique identifier]
**Visual Anchor:** "[15-25 word sensory metaphor that captures the entire design feeling]"
**Spectrum Position:** 
Luminosity [X]% | Materiality [X]% | Temperature [X]% | Shape [X]%
---

### Design Intent
**Colors:** [Intent description referencing Visual Anchor OR specific HSL values]
**Typography:** [Font names OR character description]
**Animation Character:** [single word]
**Image Direction:**
- Subject: [description]
- Mood: [description]
- Treatment: [description]
---
### Page Configuration
**Industry:** [specific business type]
**Mobile Priority:** [desktop-primary | mobile-primary | balanced]
**Page Depth:** [compact: 3-4 sections | standard: 5-6 sections | comprehensive: 7+]
---
### Section Priority
1. **[CRITICAL] Hero** — [specific requirements, key message]
2. **[CRITICAL] Services** — [number of services, display approach]
3. **[HIGH] Contact** — [what contact methods to emphasize]
4. **[MEDIUM] About** — [what story to tell]
5. **[LOW/OPTIONAL] FAQ** — [if included, why]
---
### Special Requirements
[Any unique constraints, must-haves, or specific requests from the PRD]
[Unusual features or functionality needed]
[Things to specifically avoid if mentioned in PRD]
---
## CONTENT APPENDIX
[All compressed content using structured notation above]
[Maximum 1,500 words]
[Only real content from PRD — never invented]

---
**Implementation Instruction:**
Build this landing page as a single-page React application. Reference the Visual Anchor "[Concept Name]" for all aesthetic decisions. The design should feel like: "[repeat the Visual Anchor metaphor]"

```

---
## TRUST THE AI CODER
The AI Coder (Lovable.dev) handles these automatically and well. Do NOT specify:
| ❌ Don't Specify | ✅ Instead Communicate |
|------------------|------------------------|
| Exact pixel values, spacing numbers | "Generous whitespace" / "Intimate, cozy spacing" |
| Animation timings, easing curves | "Confident motion" / "Gentle, subtle movement" |
| Z-index values, layering details | "Cards should feel elevated, floating above" |
| Responsive breakpoint specifics | "Mobile-first" or "Desktop-primary" |
| Icon selections | "Icon representing [purpose]" |
| Shadow values, blur amounts | "Soft shadow suggesting depth" / "Grounded, minimal shadow" |
| Grid column counts, flexbox code | "Magazine-style layout" / "Card grid" |
| Hex codes, RGB values | HSL values or color intent descriptions |
**The principle:** Describe the *feeling* and *intent*. Trust implementation details to the AI Coder.
---
## PRE-OUTPUT VERIFICATION
Before outputting Phase 1, verify internally:
### Design Communication
- [ ] Visual Anchor is a rich sensory metaphor (15-25 words, not generic)
- [ ] Four-spectrum values assigned and consistent with metaphor
- [ ] Animation character is ONE word that fits the concept
- [ ] Color intent is clear and matches Visual Anchor mood

### Content Integrity  
- [ ] ALL content comes directly from PRD
- [ ] NO invented testimonials, awards, statistics, or years in business
- [ ] Content appendix ≤ 1,500 words
- [ ] Headlines preserved exactly, not paraphrased
- [ ] Inferences marked clearly where made
### Structure
- [ ] Sections prioritized with CRITICAL/HIGH/MEDIUM/LOW
- [ ] Mobile priority specified based on industry/audience
- [ ] Page depth matches PRD scope (don't add sections for content that doesn't exist)

### Phase 2 Readiness
- [ ] Visual Anchor can be referenced consistently in Phase 2
- [ ] No implementation details specified that would conflict with polish phase
- [ ] Premium enhancements identified internally for Phase 2 generation

---


## QUICK REFERENCE

| Decision | Communicate | Don't Specify |
|----------|-------------|---------------|
| Colors | "Warm amber tones" or HSL | Hex codes, RGB, specific Tailwind classes |
| Spacing | "Generous", "Intimate", "Breathing room" | px, rem, gap-4, specific values |
| Animation | "Confident", "Subtle", "Gentle" | Durations, easing functions, keyframes |
| Layout | "Magazine-style", "Cards feel elevated" | Grid columns, flexbox properties |
| Typography | Font names or "Trustworthy, refined" | Font sizes, line heights, weights |
| Shadows | "Elevated", "Floating", "Grounded" | Shadow-lg, blur values, opacity |
| Images | "Soft edges into background" | Specific gradients, mask code |

---

## EXECUTION

**Based on the PRD from this Chat:**

1. Complete the Reasoning Protocol internally
2. Synthesize the Visual Concept (spectrum + metaphor + name)
3. Determine design communication approach based on PRD completeness
4. Compress all content preserving meaning and authenticity
5. Verify against Pre-Output checklist
6. Output Phase 1 prompt only
7. Await user request for Phase 2

**Output Phase 1 immediately. Make informed inferences for industry conventions. Never invent business facts. Trust the AI Coder to implement your vision brilliantly.**

---

Optimized for AI Prompter → AI Coder communication
*Phase 1 target: 2,300-2,900 words | Phase 2 target: 900-1,300 words | Content appendix max: 1,500 words*

---`;

      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, prompt);
      return { success: true, length: prompt.length };
    param: perplexityPrompt3
  - type: js
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: perplexitySend3
  - type: js
    code: |
      const maxWait = 600;
      let waited = 0;
      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, 3000));
        waited += 3;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput, textarea');
        if (!stop && textarea) return { finished: true, waitedSeconds: waited };
    param: perplexityWait3
    code: |
      const latestMessage = Array.from(
        document.querySelectorAll('[data-message-author-role="assistant"], article')
      ).filter((el) => window.getComputedStyle(el).display !== 'none').pop();
      let copiedText = '';
      if (latestMessage) copiedText = latestMessage.innerText || latestMessage.textContent || '';
      return { copiedText, length: copiedText.length };
    param: frameworkOutput

  # 7) Phase 2 trigger prompt in Perplexity
    message: Submitting Phase 2 trigger prompt to Perplexity
      const prompt = `# PHASE 2 TRIGGER PROMPT
---
## Generate Phase 2: Premium Polish
You previously generated a Phase 1 prompt for the Business from the PRD using the your design concept. The user has reviewed the implementation and is ready for the premium polish phase.

### Your Task
Generate the Phase 2 prompt that elevates the existing implementation. Phase 2 focuses on:

**Interaction & Motion**
- Enhanced hover states (micro-interactions that feel alive)
- Scroll-triggered animations (elements revealing with purpose)
- State transitions (smooth, intentional feedback)
**Visual Depth**
- Layering and dimensional effects
- Background visual interest (subtle patterns, gradients, atmospheric elements)  
- Image integration refinements (soft edges, blending, contextual placement)

**Delightful Details**
- Moments of unexpected polish that elevate perception
- Details that make the site feel crafted, not templated
- Small touches aligned with the Visual Anchor mood
### Phase 2 Rules
1. **Reference, don't redefine** — Use the existing Concept Name and Visual Anchor. Don't re-explain the design system.

2. **Enhance, don't rebuild** — No structural changes, no new sections, no content changes.

3. **Specific but not prescriptive** — Describe what interactions should *feel like*, not exact implementation code.
4. **Prioritize impact** — Focus on 3-5 high-impact enhancements rather than exhaustive lists.
5. **Stay on-brand** — All enhancements must feel consistent with the Visual Anchor metaphor.
### Phase 2 Output Format
```markdown
# [BUSINESS NAME] — Phase 2: Premium Polish
## Enhancing "[Concept Name]"
### Interaction Enhancements
[2-3 specific interaction improvements with intent descriptions]
### Motion Refinements  
[2-3 animation enhancements that add life and purpose]
### Visual Depth Additions
[1-2 layering or atmospheric enhancements]

### Detail Polish
[1-2 small delightful touches]
---
Refine the existing implementation with these enhancements. 
Maintain the "[Visual Anchor metaphor]" feeling throughout.
Do not change structure or content — only elevate the craft.
```
### Anti-Patterns (Avoid)
- ❌ Repeating any content from Phase 1
- ❌ Suggesting structural changes or new sections
- ❌ Specifying exact CSS values or animation timings
- ❌ Generic requests ("make it more modern")
- ❌ Changes that contradict the Visual Anchor mood
**Generate the Phase 2 prompt now, building on the established Design foundation established in Phase 1.**`;
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      input.focus();
      await new Promise(r => setTimeout(r, 500));
      setReactValue(input, prompt);
      return { success: true, length: prompt.length };
    param: perplexityPrompt4
  - type: js
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      return { error: 'No send' };
    param: perplexitySend4
        await new Promise(r => setTimeout(r, 3000));
        waited += 3;
        const stop = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput, textarea');
        if (!stop && textarea) return { finished: true, waitedSeconds: waited };
    param: perplexityWait4
  - type: js
    code: |
      const latestMessage = Array.from(
        document.querySelectorAll('[data-message-author-role="assistant"], article')
      ).filter((el) => window.getComputedStyle(el).display !== 'none').pop();
      let copiedText = '';
      if (latestMessage) copiedText = latestMessage.innerText || latestMessage.textContent || '';
      return { copiedText, length: copiedText.length };
    param: phase2Output

  # 8) Open Lovable.dev and submit framework output
    message: Opening Lovable.dev and submitting Phase 1 prompt
  - type: navigate
    url: https://lovable.dev/
    waitForIdle: true
    timeout: 8000
    code: |
      const text = (args.frameworkOutput && args.frameworkOutput.copiedText) || '';
      const input = document.querySelector('textarea#chatinput, textarea, [contenteditable="true"], div[role="textbox"]');
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      setReactValue(input, text);
      return { success: Boolean(text), length: text.length };
    args: frameworkOutput
    param: lovablePaste1
    code: |
      const btn = document.querySelector('button#chatinput-send-message-button, button[aria-label*="Send"], form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } }
      const input = document.querySelector('textarea#chatinput, textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: lovableSend1
      const checkInterval = 5;
        if (thumbsUpButton && textarea) return { finished: true, waitedSeconds: waited };
    param: lovableWait1

  # 9) Submit Phase 2 prompt in Lovable
    message: Submitting Phase 2 prompt in Lovable
      const text = (args.phase2Output && args.phase2Output.copiedText) || '';
      const input = document.querySelector('textarea#chatinput, textarea, [contenteditable="true"], div[role="textbox"]');
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      setReactValue(input, text);
    args: phase2Output
    param: lovablePaste2
      const btn = document.querySelector('button#chatinput-send-message-button, button[aria-label*="Send"], form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } }
      const input = document.querySelector('textarea#chatinput, textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      }
      return { error: 'No send' };
    param: lovableSend2
      const checkInterval = 5;
        const thumbsUpButton = document.querySelector('svg.shrink-0.h-4.w-4[fill="currentColor"]');
        if (thumbsUpButton && textarea) return { finished: true, waitedSeconds: waited };
      return { finished: false, timedOut: true, waitedSeconds: waited };
    param: lovableWait2
    code: |
      return { url: window.location.href };
    param: lovableEditorUrl
  # 10) Post Lovable editor URL back to Perplexity chat
    message: Returning Lovable editor URL to Perplexity
    url: "{{perplexityChatUrl.url}}"
    code: |
      const text = `Lovable editor URL: ${args.lovableEditorUrl && args.lovableEditorUrl.url ? args.lovableEditorUrl.url : window.location.href}`;
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (!input) return { error: 'No input' };
      const setReactValue = (el, value) => {
        const desc = Object.getOwnPropertyDescriptor(el.__proto__, 'value');
        const setter = desc && desc.set;
        if (setter) setter.call(el, value); else el.value = value;
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
      };
      setReactValue(input, text);
      return { success: true, textLength: text.length };
    args:
      lovableEditorUrl: lovableEditorUrl
    param: perplexityReturnUrl
    code: |
      const btn = document.querySelector('button[aria-label*="Send"], button#chat-submit, form button');
      if (btn && !btn.disabled) { btn.click(); return { success: true } }
      const input = document.querySelector('textarea, [contenteditable="true"], div[role="textbox"]');
      if (input) {
        input.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, bubbles: true }));
        return { success: true, method: 'enter' };
      return { error: 'No send' };
    param: perplexitySendUrl
    message: Pasting ChatGPT image prompt into Lovable
  - type: js
    code: |
      const text = (args.chatgptOutput && args.chatgptOutput.copiedText) || '';

      await new Promise(r => setTimeout(r, 2000));

      const input = document.querySelector('textarea#chatinput');

      if (!input) return { error: 'No input found' };

      input.focus();

      await new Promise(r => setTimeout(r, 1000));

      const nativeInputValueSetter =
        Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype, 'value').set;

      nativeInputValueSetter.call(input, text);

      input.dispatchEvent(new Event('input', { bubbles: true }));
      input.dispatchEvent(new Event('change', { bubbles: true }));

      await new Promise(r => setTimeout(r, 500));

      return { success: Boolean(text), length: text.length };
    args: chatgptOutput
    param: lovablePasteChatgpt
  - type: wait
    timeout: 2000
    for: idle
  - type: say
    message: Submitting ChatGPT image prompt
  - type: js
    code: |
      await new Promise(r => setTimeout(r, 1000));

      const btn = document.querySelector('button#chatinput-send-message-button');

      if (!btn || btn.disabled) return { error: 'Button not ready' };

      btn.click();

      await new Promise(r => setTimeout(r, 1000));

      return { success: true };
    param: lovableSubmit3
  - type: say
    message: Waiting for ChatGPT prompt generation
  - type: js
    code: |
      const maxWait = 600;
      let waited = 0;
      const checkInterval = 3;
      let generationStarted = false;

      while (waited < maxWait) {
        await new Promise(r => setTimeout(r, checkInterval * 1000));
        waited += checkInterval;

        const stopBtn = document.querySelector('button[aria-label*="Stop"]');
        const textarea = document.querySelector('textarea#chatinput');
        const button = document.querySelector('button#chatinput-send-message-button');

        const textareaReady = textarea && !textarea.disabled;
        const buttonExists = !!button;
        const buttonDisabled = button && button.disabled;

        if (stopBtn || buttonDisabled) {
          generationStarted = true;
        }

        if (generationStarted && !stopBtn && textareaReady && buttonExists && !buttonDisabled) {
          return { finished: true, waitedSeconds: waited, generationStarted };
        }

        if (waited % 15 === 0) {
          console.log('Still generating ChatGPT prompt...', waited, 'seconds');
        }
      }
      return { finished: false, timedOut: true, waitedSeconds: waited, generationStarted };
    param: lovableWait3
  - type: wait
    timeout: 2000
    for: idle
  - type: say
    message: Extracting links
  - type: js
    code: >
      await new Promise(r => setTimeout(r, 3000));


      const editor = window.location.href;

      console.log('Editor URL:', editor);


      let preview = '';


      const previewSvg = document.querySelector('svg.shrink-0.h-4.w-4[viewBox="0
      0 24 24"]');

      if (previewSvg) {
        let parent = previewSvg.parentElement;
        let attempts = 0;
        while (parent && attempts < 10) {
          if (parent.tagName === 'A' && parent.href) {
            preview = parent.href;
            console.log('Found preview via SVG parent:', preview);
            break;
          }
          parent = parent.parentElement;
          attempts++;
        }
      }


      if (!preview) {
        const allLinks = document.querySelectorAll('a[href]');
        for (const link of allLinks) {
          const title = link.getAttribute('title');
          const ariaLabel = link.getAttribute('aria-label');
          if (title && title.includes('preview') || ariaLabel && ariaLabel.includes('preview')) {
            preview = link.href;
            console.log('Found preview via tooltip:', preview);
            break;
          }
        }
      }


      if (!preview) {
        const allLinks = document.querySelectorAll('a[href]');
        for (const link of allLinks) {
          if (link.href && /preview.*\.lovable\.app/.test(link.href)) {
            preview = link.href;
            console.log('Found preview via URL pattern:', preview);
            break;
          }
        }
      }


      if (!preview) {
        const urlInput = document.querySelector('input#preview-url-bar');
        if (urlInput && urlInput.value) {
          const value = urlInput.value;
          if (value.startsWith('http')) {
            preview = value;
          } else {
            const baseLinkMatch = editor.match(/(https:\/\/[^\/]+)/);
            if (baseLinkMatch) {
              preview = value.startsWith('/') ? baseLinkMatch[1] + value : value;
            }
          }
          console.log('Found preview via input field:', preview);
        }
      }


      if (!preview) {
        preview = 'Preview link not found - check Lovable manually';
        console.log('Could not find preview link');
      }


      return { editorUrl: editor, previewUrl: preview, success: true };
    param: lovableLinks
  - type: say
    message: Links captured
  - type: wait
    timeout: 2000
    for: idle
  - type: say
    message: Returning to Perplexity
  - type: navigate
    url: '{{finalChatUrl}}'
    waitForIdle: true
  - type: wait
    timeout: 5000
    for: idle
  - type: say
    message: Sending data collection
  - type: wait
    timeout: 2000
    for: idle
  - type: js
    code: >
      const editor = args.lovableLinks.editorUrl;

      const preview = args.lovableLinks.previewUrl;

      const prompt = 'You are completing website redesign automation. Analysis
      and Lovable creation complete. Extract and format key data. LOVABLE LINKS:
      Editor ' + editor + ' Preview ' + preview + ' TASK: Generate single TSV
      row with 11 columns in exact order: 1. Business name 2. Lovable Editor
      Link 3. Lovable Preview 4. Date Germany timezone YYYY-MM-DD HH:MM 5.
      Business Type concise like Zahnarzt Restaurant Schreinerei 6. Email 7. Old
      Site Issues 2-3 point summary 8. Old Site Examples 1-2 concrete examples
      9. Old Site UI flaws visual interaction problems 10. Improvement potential
      high-impact opportunities 11. Benefits of improvements business outcomes.
      DATA SOURCES: Extract from conversation business intelligence extraction,
      design research, website assessment. FORMATTING: Single line fields
      separated by TAB, NO headers NO extra lines NO markdown around TSV, strip
      internal tabs newlines, max 200 chars per field, use NA only if unknown,
      place ONLY TSV in code block. QUALITY CHECKS: Exactly 11 fields, date
      Germany timezone, business type specific, examples concrete, single line
      only. OUTPUT: Return ONLY code block with single TSV row, no text before
      or after. Example structure: BusinessName TAB editor-url TAB preview-url
      TAB 2025-01-20 14:30 TAB Restaurant TAB email TAB issues TAB examples TAB
      flaws TAB improvements TAB benefits. Generate actual TSV row now using
      conversation data.';


      console.log('Prompt:', prompt);


      const selectors = ['textarea', 'div[contenteditable="true"]',
      '[role="textbox"]'];

      let input = null;

      for (const sel of selectors) {
        const el = document.querySelector(sel);
        if (el && window.getComputedStyle(el).display !== 'none') {
          input = el;
          console.log('Found input:', sel);
          break;
        }
      }


      if (!input) {
        console.error('No input found');
        return { error: 'Input not found', success: false };
      }


      function setReactValue(element, value) {
        if (element.tagName === 'TEXTAREA') {
          const setter = Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype, 'value').set;
          setter.call(element, value);
        } else {
          element.textContent = value;
        }
        element.dispatchEvent(new Event('input', { bubbles: true }));
      }


      input.focus();

      await new Promise(r => setTimeout(r, 500));


      try {
        const success = document.execCommand('insertText', false, prompt);
        if (!success) {
          console.log('execCommand failed, using setReactValue');
          setReactValue(input, prompt);
        }
      } catch (e) {
        console.log('execCommand error:', e);
        setReactValue(input, prompt);
      }


      return { success: true, promptLength: prompt.length };
    args: lovableLinks
    param: dataPrompt
  - type: js
    code: >
      await new Promise(r => setTimeout(r, 1000));


      const buttonSelectors = [
        'button[type="submit"]',
        'button[aria-label*="Submit"]',
        'button[aria-label*="Send"]'
      ];


      for (const sel of buttonSelectors) {
        const buttons = Array.from(document.querySelectorAll(sel));
        for (const btn of buttons) {
          const style = window.getComputedStyle(btn);
          if (style.display !== 'none' && !btn.disabled) {
            console.log('Clicking submit button');
            btn.click();
            return { success: true, method: 'button' };
          }
        }
      }


      const input = document.querySelector('textarea, [contenteditable="true"],
      [role="textbox"]');

      if (!input) return { error: 'Input lost' };


      input.focus();


      const form = input.closest('form');

      if (form) {
        console.log('Submitting form');
        form.requestSubmit();
        return { success: true, method: 'form' };
      }


      console.log('Using Enter key');

      input.dispatchEvent(new KeyboardEvent('keydown', {
        key: 'Enter',
        code: 'Enter',
        keyCode: 13,
        bubbles: true,
        cancelable: true
      }));


      return { success: true, method: 'keyboard' };
    param: dataSubmit
  - type: say
    message: AUTOMATION COMPLETE
version: 1
